<!DOCTYPE html>
<head>
<%= stylesheet_link_tag    "materialize.css", :type => "text/css", :media => "screen,projection" %>
</head>
<html >


<body class = "teal lighten-4">
<%= render 'pages/navbar', controller: :pages%>


<div class="row">
      <div class="col s12">
        <div class="card teal darken-3">
          <div class="card-content white-text">
            <h1 id = "winner" class="card-title center"></h1>
       <table id = "connected_users">
        <thead>
          <tr>
              <th>Name</th>
              <th>Score</th>
          </tr>
          <tbody>
            <% @connected.order('score DESC').each do |conn| %>
          <tr>
            <td><%=conn.username%></td>
            <td><%=conn.score%></td>
          </tr>
          <% end %>
       </tbody>
    </thead>
  </table>
          </div>
       </div>
      </div>
      </div>
</body>

<script>
  document.getElementById("winner").innerHTML = (document.getElementById("connected_users").rows[1].cells[0].innerHTML + " Wins!").italics();
  

  window.onpopstate = function(event) 
      {
       
        $.ajax({
                url: "/landing",
                type: 'GET'
                });
      
     }
    
    window.onbeforeunload = function(e)
     {
      
      $.ajax({
                url: "/landing",
                type: 'GET'
                });
    
   }
 
              
              
  
        
  
</script>
</html>